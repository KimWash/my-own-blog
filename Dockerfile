FROM node:21-alpine

ARG DATABASE_URL
ARG MINIO_URL
ARG MINIO_ACCESS_KEY
ARG MINIO_PRIVATE_KEY

ENV DATABASE_URL=$DATABASE_URL
ENV MINIO_URL=$MINIO_URL
ENV MINIO_ACCESS_KEY=$MINIO_ACCESS_KEY
ENV MINIO_PRIVATE_KEY=$MINIO_PRIVATE_KEY


WORKDIR /app

COPY package*.json ./

RUN npm install -g only-allow

RUN npm install

COPY . .

EXPOSE 3000

RUN npm run build

CMD npm run start 